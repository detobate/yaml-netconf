ACL:
  acl_type: ipv4-acl
  acl_name: "SAP-Subscriber-Ingress"
  description: "SAP Ingress IPv4 ACL"
  rules:
    - description: "Test multiple sources"
      source: "{{ distbng['ipv4'] }}"
      dest: "any"
      proto: "{{ service_ssh['proto']}}"
      sport: "{{ service_ssh['sport']}}"
      dport: "{{ service_ssh['dport']}}"
      actions: "deny"

    - description: "Test different actions"
      source: "{{ distbng['ipv4'] }}"
      dest: "any"
      proto: "any"
      sport: "any"
      dport: "any"
      actions: "permit"

    - description: "test protocol matching with multiple sources"
      source: "any"
      dest: "{{ distbng['ipv4'] }}"
      proto: "icmp"
      sport: "any"
      dport: "any"
      actions: "deny"

    - description: "test port range matching"
      source: "any"
      dest: "{{ distbng['ipv4'] }}"
      proto: "any"
      sport: "any"
      dport:
          startrange: "1024"
          endrange: "65535"
      actions: "deny"

    - description: "test hostgroups w/ multi source and multi dest"
      source: "{{ distbng.ipv4 }}"          ## Testing dot notation
      dest: "{{ cdns.hosts }}"              ## Testing dot notation
      proto: "{{ service_dns['proto'] }}"
      sport: "{{ service_dns['sport'] }}"
      dport: "{{ service_dns['dport'] }}"
      actions: "permit"

    - description: "test variable port range"
      source: "{{ distbng['ipv4'] }}"
      dest: "any"
      proto: "{{ service_testportrange['proto'] }}"
      sport: "{{ service_testportrange['sport'] }}"
      dport: "{{ service_testportrange['dport'] }}"
      actions: "permit"
